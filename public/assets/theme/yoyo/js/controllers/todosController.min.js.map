{"version":3,"sources":["todosController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"todosController.min.js","sourcesContent":["define(['handlebars', 'handlebarsHelpers'], function(Handlebars, handlebarHelpers) {\r\n    var todoController = function() {\r\n        var todoCtrl = {\r\n            init: function() {\r\n                this.cacheDom();\r\n                this.ajaxLoadForm();\r\n                this.onFormSubmit();\r\n            },\r\n            cacheDom: function() {\r\n                this.$txtTodoTitle = $('#txtTodoTitle');\r\n                this.$txtTodoText = $('#txtTodoText');\r\n                this.$todo = $('#todos');\r\n                this.$notes = $('#notes');\r\n                this.$form = $('#form-todo');\r\n                this.$formBtn = $('#todo-form #btnSubmit');\r\n                this.$modal = $('#yoyoModal');\r\n                this.$formModal = $('#formTodoModal');\r\n                this.$formTodoModal = $('#form-todo-modal');\r\n                this.$todoTimeline = $('#todo-timeline');\r\n                this.$notesTimeline = $('#notes-timeline');\r\n            },\r\n            loadModalMessage: function(msg) {\r\n                this.$modal.find('.modal-body span').text(msg);\r\n                this.$modal.modal('show');\r\n                this.ajaxLoadForm();\r\n                setTimeout(function() {\r\n                    todoCtrl.$modal.modal('hide');\r\n                }, 2000);\r\n            },\r\n            ajaxLoadForm: function() {\r\n                $.ajax({\r\n                    url: this.$todo.data('ajax-url'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        todoCtrl.$todoTimeline.html('<p class=\"text-center\">Loading content...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    var template = $('#todo-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.results  !== 'undefined') {\r\n                        todoCtrl.$todoTimeline.html(template(data));\r\n                        todoCtrl.onConversion();\r\n                        todoCtrl.onDelete();\r\n                        todoCtrl.todoAction();\r\n                        todoCtrl.onUpdate();\r\n                    }\r\n                });\r\n            },\r\n            ajaxLoadNotesForm: function() {\r\n                $.ajax({\r\n                    url: this.$notes.data('ajax-url'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        todoCtrl.$notesTimeline.html('<p class=\"text-center\">Loading content...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    var template = $('#notes-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.results  !== 'undefined') {\r\n                        todoCtrl.$notesTimeline.html(template(data));\r\n                    }\r\n                });\r\n            },\r\n            ajaxSubmitForm: function() {\r\n                $.ajaxSetup({\r\n                    headers: {\r\n                        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n                    }\r\n                });\r\n                $.ajax({\r\n                    url: this.$form.attr('action'),\r\n                    type: 'post',\r\n                    data: this.$form.serialize(),\r\n                    dataType: 'json',\r\n                }).done(function(data) {\r\n                    var template = $('#todo-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            todoCtrl.$txtTodoTitle.val('');\r\n                            todoCtrl.$txtTodoText.val('');\r\n                            todoCtrl.$modal.find('.modal-body span').text(data.message);\r\n                            todoCtrl.$modal.modal('show');\r\n                            todoCtrl.ajaxLoadForm();\r\n                            setTimeout(function() {\r\n                                todoCtrl.$modal.modal('hide');\r\n                            }, 2000);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxConversion: function(el) {\r\n                $.ajax({\r\n                    url: el.attr('href'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        todoCtrl.$todoTimeline.html('<p class=\"text-center\">Processing conversion...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            todoCtrl.$modal.find('.modal-body span').text(data.message);\r\n                            todoCtrl.$modal.modal('show');\r\n                            todoCtrl.ajaxLoadForm();\r\n                            todoCtrl.ajaxLoadNotesForm();\r\n                            setTimeout(function() {\r\n                                todoCtrl.$modal.modal('hide');\r\n                            }, 2000);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxDelete: function(el) {\r\n                $.ajax({\r\n                    url: el.attr('href'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        todoCtrl.$todoTimeline.html('<p class=\"text-center\">Deleting item...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            todoCtrl.$modal.find('.modal-body span').text(data.message);\r\n                            todoCtrl.$modal.modal('show');\r\n                            todoCtrl.ajaxLoadForm();\r\n                            todoCtrl.ajaxLoadNotesForm();\r\n                            setTimeout(function() {\r\n                                todoCtrl.$modal.modal('hide');\r\n                            }, 2000);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxUpdate: function() {\r\n                $.ajax({\r\n                    url: this.$formTodoModal.attr('action'),\r\n                    dataType: 'json',\r\n                    type: 'post',\r\n                    data: this.$formTodoModal.serialize(),\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            todoCtrl.loadModalMessage(data.message);\r\n                        }\r\n                    }\r\n                }).always(function() {\r\n                    todoCtrl.$formModal.modal('hide');\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            onConversion: function() {\r\n                $(document).on('click', 'a.todo-to-note', function(e) {\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    todoCtrl.ajaxConversion($(this));\r\n                });\r\n            },\r\n            onDelete: function() {\r\n                $(document).on('click', 'a.delete-todo', function(e) {\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    todoCtrl.ajaxDelete($(this));\r\n                });\r\n            },\r\n            onUpdate: function() {\r\n                var formAction = this.$formTodoModal.attr('action');\r\n\r\n                $(document).on('click', 'a.todo-title', function(e) {\r\n                    var $this = $(this);\r\n                    var $timelineContainer = $this.closest('.todo-container');\r\n                    var formActionUpdateUrl = formAction + '/' + $timelineContainer.find('.hfTodoId').val();\r\n\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    todoCtrl.$formTodoModal.attr('action', formActionUpdateUrl);\r\n                    todoCtrl.$formTodoModal.find('#txtTodoTitle').val($this.text());\r\n                    todoCtrl.$formTodoModal.find('#txtTodoText').val($timelineContainer.find('.todo-text').text());\r\n\r\n                    todoCtrl.$formModal.modal('show');\r\n                });\r\n                this.$formTodoModal.submit(function(e){\r\n                    e.preventDefault();\r\n                    todoCtrl.ajaxUpdate();\r\n                });\r\n            },\r\n            ajaxTodo: function(el, elVal, elIsChecked, elContainer) {\r\n                $.ajax({\r\n                    url: this.$todoTimeline.data('ajax-url'),\r\n                    dataType: 'json',\r\n                    type: 'post',\r\n                    data: {todo_id: elVal, is_done: elIsChecked},\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        var $todoContainer = el.closest('.todo-container');\r\n                        var $noteTitle = $todoContainer.find('.todo-title');\r\n                        var $noteText = $todoContainer.find('p');\r\n\r\n                        if (elIsChecked) {\r\n                            $todoContainer.addClass('bg-success');\r\n                            $noteTitle.wrap('<strike></strike>');\r\n                            $noteText.wrap('<strike></strike>');\r\n                        } else {\r\n                            $todoContainer.removeClass('bg-success');\r\n                            $noteTitle.unwrap();\r\n                            $noteText.unwrap();\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error;')\r\n                });\r\n            },\r\n            todoAction: function() {\r\n                var el;\r\n\r\n                $(document).on('click', '.cbx-is-done', function() {\r\n                    el = $(this);\r\n                    todoCtrl.ajaxTodo(el, el.val(), el.prop('checked'), todoCtrl.$todoTimeline);\r\n                });\r\n            },\r\n            onFormSubmit: function() {\r\n                this.$form.submit(function(e){\r\n                    e.preventDefault();\r\n                    todoCtrl.ajaxSubmitForm();\r\n                });\r\n            }\r\n        }\r\n\r\n        todoCtrl.init();\r\n    }\r\n\r\n    return todoController;\r\n});"],"sourceRoot":"/source/"}