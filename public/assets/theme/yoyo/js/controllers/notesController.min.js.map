{"version":3,"sources":["notesController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"notesController.min.js","sourcesContent":["define(['handlebars', 'handlebarsHelpers'], function(Handlebars, handlebarHelpers) {\r\n    var notesController = function() {\r\n        var notesCtrl = {\r\n            init: function() {\r\n                this.cacheDom();\r\n                this.ajaxLoadForm();\r\n                this.onFormSubmit();\r\n            },\r\n            cacheDom: function() {\r\n                this.$txtNoteTitle = $('#txtNoteTitle');\r\n                this.$txtNoteText = $('#txtNoteText');\r\n                this.$todo = $('#todos');\r\n                this.$notes = $('#notes');\r\n                this.$form = $('#form-notes');\r\n                this.$formBtn = $('#notes-form #btnSubmit');\r\n                this.$modal = $('#yoyoModal');\r\n                this.$formModal = $('#formNotesModal');\r\n                this.$formNotesModal = $('#form-notes-modal');\r\n                this.$notesTimeline = $('#notes-timeline');\r\n                this.$todoTimeline = $('#todo-timeline');\r\n            },\r\n            loadModalMessage: function(msg) {\r\n                this.$modal.find('.modal-body span').text(msg);\r\n                this.$modal.modal('show');\r\n                this.ajaxLoadForm();\r\n                setTimeout(function() {\r\n                    notesCtrl.$modal.modal('hide');\r\n                }, 2000);\r\n            },\r\n            ajaxLoadForm: function() {\r\n                $.ajax({\r\n                    url: this.$notes.data('ajax-url'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        notesCtrl.$notesTimeline.html('<p class=\"text-center\">Loading content...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    var template = $('#notes-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.results  !== 'undefined') {\r\n                        notesCtrl.$notesTimeline.html(template(data));\r\n                        notesCtrl.onConversion();\r\n                        notesCtrl.onDelete();\r\n                        notesCtrl.onUpdate();\r\n                    }\r\n                });\r\n            },\r\n            ajaxLoadTodoForm: function() {\r\n                $.ajax({\r\n                    url: this.$todo.data('ajax-url'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        notesCtrl.$todoTimeline.html('<p class=\"text-center\">Loading content...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    var template = $('#todo-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.results  !== 'undefined') {\r\n                        notesCtrl.$todoTimeline.html(template(data));\r\n                    }\r\n                });\r\n            },\r\n            ajaxSubmitForm: function() {\r\n                $.ajaxSetup({\r\n                    headers: {\r\n                        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n                    }\r\n                });\r\n                $.ajax({\r\n                    url: this.$form.attr('action'),\r\n                    type: 'post',\r\n                    data: this.$form.serialize(),\r\n                    dataType: 'json',\r\n                }).done(function(data) {\r\n                    var template = $('#notes-template');\r\n                    var source   = template.html();\r\n                    var template = Handlebars.compile(source);\r\n\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            notesCtrl.$txtNoteTitle.val('');\r\n                            notesCtrl.$txtNoteText.val('');\r\n                            notesCtrl.loadModalMessage(data.message);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxConversion: function(el) {\r\n                $.ajax({\r\n                    url: el.attr('href'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        notesCtrl.$notesTimeline.html('<p class=\"text-center\">Processing conversion...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            notesCtrl.ajaxLoadTodoForm();\r\n                            notesCtrl.loadModalMessage(data.message);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxDelete: function(el) {\r\n                $.ajax({\r\n                    url: el.attr('href'),\r\n                    dataType: 'json',\r\n                    type: 'get',\r\n                    beforeSend: function() {\r\n                        notesCtrl.$notesTimeline.html('<p class=\"text-center\">Deleting item...</p>');\r\n                    }\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            notesCtrl.ajaxLoadTodoForm();\r\n                            notesCtrl.loadModalMessage(data.message);\r\n                        } else {\r\n                            console.log('false');\r\n                        }\r\n                    }\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            ajaxUpdate: function() {\r\n                $.ajax({\r\n                    url: this.$formNotesModal.attr('action'),\r\n                    dataType: 'json',\r\n                    type: 'post',\r\n                    data: this.$formNotesModal.serialize(),\r\n                }).done(function(data) {\r\n                    if (typeof data.transaction !== 'undefined') {\r\n                        if (data.transaction) {\r\n                            notesCtrl.loadModalMessage(data.message);\r\n                        }\r\n                    }\r\n                }).always(function() {\r\n                    notesCtrl.$formModal.modal('hide');\r\n                }).error(function() {\r\n                    alert('Error');\r\n                });\r\n            },\r\n            onConversion: function() {\r\n                $(document).on('click', 'a.note-to-todo', function(e) {\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    notesCtrl.ajaxConversion($(this));\r\n                });\r\n            },\r\n            onDelete: function() {\r\n                $(document).on('click', 'a.delete-note', function(e) {\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    notesCtrl.ajaxDelete($(this));\r\n                });\r\n            },\r\n            onUpdate: function() {\r\n                var formAction = this.$formNotesModal.attr('action');\r\n\r\n                $(document).on('click', 'a.note-title', function(e) {\r\n                    var $this = $(this);\r\n                    var $timelineContainer = $this.parents('.timeline-content');\r\n                    var formActionUpdateUrl = formAction + '/' + $timelineContainer.find('.hfNoteId').val();\r\n\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    notesCtrl.$formNotesModal.attr('action', formActionUpdateUrl);\r\n                    notesCtrl.$formNotesModal.find('#txtNoteTitle').val($this.text());\r\n                    notesCtrl.$formNotesModal.find('#txtNoteText').val($timelineContainer.find('.note-text').text());\r\n\r\n                    notesCtrl.$formModal.modal('show');\r\n                });\r\n                this.$formNotesModal.submit(function(e){\r\n                    e.preventDefault();\r\n                    notesCtrl.ajaxUpdate();\r\n                });\r\n            },\r\n            onFormSubmit: function() {\r\n                this.$form.submit(function(e){\r\n                    e.preventDefault();\r\n                    notesCtrl.ajaxSubmitForm();\r\n                });\r\n            }\r\n        }\r\n\r\n        notesCtrl.init();\r\n    }\r\n\r\n    return notesController;\r\n});"],"sourceRoot":"/source/"}